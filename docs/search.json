[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction to single-cell RNA-seq",
    "section": "",
    "text": "This repository has teaching materials for a hands-on Introduction to single-cell RNA-seq workshop. This workshop will instruct participants on how to design a single-cell RNA-seq experiment, and how to efficiently manage and analyze the data starting from count matrices. This will be a hands-on workshop in which we will focus on using the Scanpy package using Python/Jupyter Lab.\n\n\n\n\n\n\nNote\n\n\n\nThese materials were developed for a trainer-led workshop, but are amenable to self-guided learning."
  },
  {
    "objectID": "index.html#applications",
    "href": "index.html#applications",
    "title": "Introduction to single-cell RNA-seq",
    "section": "Applications",
    "text": "Applications\nAnaconda"
  },
  {
    "objectID": "index.html#packages",
    "href": "index.html#packages",
    "title": "Introduction to single-cell RNA-seq",
    "section": "Packages",
    "text": "Packages\n\nconda create -n scrna_py python==3.8\nconda activate scrna_py\nconda install jupyter pandas matplotlib"
  },
  {
    "objectID": "lessons/03_SC_quality_control-setup.html",
    "href": "lessons/03_SC_quality_control-setup.html",
    "title": "Quality Control Setup",
    "section": "",
    "text": "Approximate time: 90 minutes",
    "crumbs": [
      "Day 1:",
      "Quality Control Setup"
    ]
  },
  {
    "objectID": "lessons/03_SC_quality_control-setup.html#learning-objectives",
    "href": "lessons/03_SC_quality_control-setup.html#learning-objectives",
    "title": "Quality Control Setup",
    "section": "Learning Objectives:",
    "text": "Learning Objectives:\n\nDemonstrate how to import data and set up project for upcoming quality control analysis.",
    "crumbs": [
      "Day 1:",
      "Quality Control Setup"
    ]
  },
  {
    "objectID": "lessons/03_SC_quality_control-setup.html#exploring-the-example-dataset",
    "href": "lessons/03_SC_quality_control-setup.html#exploring-the-example-dataset",
    "title": "Quality Control Setup",
    "section": "Exploring the example dataset",
    "text": "Exploring the example dataset\nFor this workshop we will be working with a single-cell RNA-seq dataset which is part of a larger study from Kang et al, 2017. In this paper, the authors present a computational algorithm that harnesses genetic variation (eQTL) to determine the genetic identity of each droplet containing a single cell (singlet) and identify droplets containing two cells from different individuals (doublets).\nThe data used to test their algorithm is comprised of pooled Peripheral Blood Mononuclear Cells (PBMCs) taken from eight lupus patients, split into control and interferon beta-treated (stimulated) conditions.\n\nImage credit: Kang et al, 2017\n\nRaw data\nThis dataset is available on GEO (GSE96583), however the available counts matrix lacked mitochondrial reads, so we downloaded the BAM files from the SRA (SRP102802). These BAM files were converted back to FASTQ files, then run through Cell Ranger to obtain the count data that we will be using.\n\n\n\n\n\n\nNote\n\n\n\nThe count data for this dataset is also freely available from 10X Genomics and is used in the Seurat tutorial.\n\n\n\n\nMetadata\nIn addition to the raw data, we also need to collect information about the data; this is known as metadata. There is often a temptation to just start exploring the data, but it is not very meaningful if we know nothing about the samples that this data originated from.\nSome relevant metadata for our dataset is provided below:\n\nThe libraries were prepared using 10X Genomics version 2 chemistry\nThe samples were sequenced on the Illumina NextSeq 500\nPBMC samples from eight individual lupus patients were separated into two aliquots each.\n\nOne aliquot of PBMCs was activated by 100 U/mL of recombinant IFN-β for 6 hours.\nThe second aliquot was left untreated.\nAfter 6 hours, the eight samples for each condition were pooled together in two final pools (stimulated cells and control cells). We will be working with these two, pooled samples. (We did not demultiplex the samples because SNP genotype information was used to demultiplex in the paper and the barcodes/sample IDs were not readily available for this data. Generally, you would demultiplex and perform QC on each individual sample rather than pooling the samples.)\n\n12,138 and 12,167 cells were identified (after removing doublets) for control and stimulated pooled samples, respectively.\nSince the samples are PBMCs, we will expect immune cells, such as:\n\nB cells\nT cells\nNK cells\nmonocytes\nmacrophages\npossibly megakaryocytes\n\n\nIt is recommended that you have some expectation regarding the cell types you expect to see in a dataset prior to performing the QC. This will inform you if you have any cell types with low complexity (lots of transcripts from a few genes) or cells with higher levels of mitochondrial expression. This will enable us to account for these biological factors during the analysis workflow.\nNone of the above cell types are expected to be low complexity or anticipated to have high mitochondrial content.",
    "crumbs": [
      "Day 1:",
      "Quality Control Setup"
    ]
  },
  {
    "objectID": "lessons/03_SC_quality_control-setup.html#set-up",
    "href": "lessons/03_SC_quality_control-setup.html#set-up",
    "title": "Quality Control Setup",
    "section": "Set up",
    "text": "Set up\nFor this workshop, we will be working within an RStudio project. In order to follow along you should have downloaded the R project.\n\n\n\n\n\n\nImportant\n\n\n\nIf you haven’t done this already, the project can be accessed using this link.",
    "crumbs": [
      "Day 1:",
      "Quality Control Setup"
    ]
  },
  {
    "objectID": "lessons/03_SC_quality_control-setup.html#project-organization",
    "href": "lessons/03_SC_quality_control-setup.html#project-organization",
    "title": "Quality Control Setup",
    "section": "Project organization",
    "text": "Project organization\nOne of the most important parts of research that involves large amounts of data, is how best to manage it. We tend to prioritize the analysis, but there are many other important aspects of data management that are often overlooked in the excitement to get a first look at new data. The HMS Data Management Working Group, discusses in-depth some things to consider beyond the data creation and analysis.\nOne important aspect of data management is organization. For each experiment you work on and analyze data for, it is considered best practice to get organized by creating a planned storage space (directory structure). We will do that for our single-cell analysis.\nLook inside your project space and you will find that a directory structure has been setup for you:\n\nsingle_cell_rnaseq/\n├── data\n├── results\n└── figures",
    "crumbs": [
      "Day 1:",
      "Quality Control Setup"
    ]
  },
  {
    "objectID": "schedule/schedule.html",
    "href": "schedule/schedule.html",
    "title": "Introduction to Single-cell RNA-seq Schedule",
    "section": "",
    "text": "Introduction to scRNA-seq\nRaw data to count matrix\nDownload this project"
  },
  {
    "objectID": "schedule/schedule.html#pre-reading",
    "href": "schedule/schedule.html#pre-reading",
    "title": "Introduction to Single-cell RNA-seq Schedule",
    "section": "",
    "text": "Introduction to scRNA-seq\nRaw data to count matrix\nDownload this project"
  },
  {
    "objectID": "lessons/02_SC_generation_of_count_matrix.html",
    "href": "lessons/02_SC_generation_of_count_matrix.html",
    "title": "Generation of count matrix",
    "section": "",
    "text": "Depending on the library preparation method used, the RNA sequences (also referred to as reads or tags), will be derived either from the 3’ ends (or 5’ ends) of the transcripts (10X Genomics, CEL-seq2, Drop-seq, inDrops) or from full-length transcripts (Smart-seq).\n\nImage credit: Papalexi E and Satija R. Single-cell RNA sequencing to explore immune cell heterogeneity, Nature Reviews Immunology 2018 (https://doi.org/10.1038/nri.2017.76)\nThe choice of method involves the biological question of interest. The following advantages are listed below for the methods:\n\n3’ (or 5’)-end sequencing:\n\nMore accurate quantification through the use of unique molecular identifiers distinguishing biological duplicates from amplification (PCR) duplicates\nLarger number of cells sequenced allows better identity of cell type populations\nCheaper per cell cost\nBest results with &gt; 10,000 cells\n\nFull length sequencing:\n\nDetection of isoform-level differences in expression\nIdentification of allele-specific differences in expression\nDeeper sequencing of a smaller number of cells\nBest for samples with low number of cells\n\n\nMany of the same analysis steps need to occur for 3’-end sequencing as for full-length, but 3’ protocols have been increasing in popularity and consist of a few more steps in the analysis. Therefore, our materials are going to detail the analysis of data from these 3’ protocols with a focus on the droplet-based methods (inDrops, Drop-seq, 10X Genomics).",
    "crumbs": [
      "Pre-reading:",
      "Generation of count matrix"
    ]
  },
  {
    "objectID": "lessons/02_SC_generation_of_count_matrix.html#single-cell-rna-seq-data---raw-data-to-count-matrix",
    "href": "lessons/02_SC_generation_of_count_matrix.html#single-cell-rna-seq-data---raw-data-to-count-matrix",
    "title": "Generation of count matrix",
    "section": "",
    "text": "Depending on the library preparation method used, the RNA sequences (also referred to as reads or tags), will be derived either from the 3’ ends (or 5’ ends) of the transcripts (10X Genomics, CEL-seq2, Drop-seq, inDrops) or from full-length transcripts (Smart-seq).\n\nImage credit: Papalexi E and Satija R. Single-cell RNA sequencing to explore immune cell heterogeneity, Nature Reviews Immunology 2018 (https://doi.org/10.1038/nri.2017.76)\nThe choice of method involves the biological question of interest. The following advantages are listed below for the methods:\n\n3’ (or 5’)-end sequencing:\n\nMore accurate quantification through the use of unique molecular identifiers distinguishing biological duplicates from amplification (PCR) duplicates\nLarger number of cells sequenced allows better identity of cell type populations\nCheaper per cell cost\nBest results with &gt; 10,000 cells\n\nFull length sequencing:\n\nDetection of isoform-level differences in expression\nIdentification of allele-specific differences in expression\nDeeper sequencing of a smaller number of cells\nBest for samples with low number of cells\n\n\nMany of the same analysis steps need to occur for 3’-end sequencing as for full-length, but 3’ protocols have been increasing in popularity and consist of a few more steps in the analysis. Therefore, our materials are going to detail the analysis of data from these 3’ protocols with a focus on the droplet-based methods (inDrops, Drop-seq, 10X Genomics).",
    "crumbs": [
      "Pre-reading:",
      "Generation of count matrix"
    ]
  },
  {
    "objectID": "lessons/02_SC_generation_of_count_matrix.html#end-reads-includes-all-droplet-based-methods",
    "href": "lessons/02_SC_generation_of_count_matrix.html#end-reads-includes-all-droplet-based-methods",
    "title": "Generation of count matrix",
    "section": "3’-end reads (includes all droplet-based methods)",
    "text": "3’-end reads (includes all droplet-based methods)\nFor the analysis of scRNA-seq data, it is helpful to understand what information is present in each of the reads and how we use it moving forward through the analysis.\nFor the 3’-end sequencing methods, reads originating from different molecules of the same transcript would have originated only from the 3’ end of the transcripts, so would have a high likelihood of having the same sequence. However, the PCR step during library preparation could also generate read duplicates. To determine whether a read is a biological or technical duplicate, these methods use unique molecular identifiers, or UMIs.\n\nReads with different UMIs mapping to the same transcript were derived from different molecules and are biological duplicates - each read should be counted.\nReads with the same UMI originated from the same molecule and are technical duplicates - the UMIs should be collapsed to be counted as a single read.\nIn image below, the reads for ACTB should be collapsed and counted as a single read, while the reads for ARL1 should each be counted.\n\n\nImage credit: modified from Macosko EZ et al. Highly Parallel Genome-wide Expression Profiling of Individual Cells Using Nanoliter Droplets, Cell 2015 (https://doi.org/10.1016/j.cell.2015.05.002)\nSo we know that we need to keep track of the UMIs, but what other information do we need to properly quantify the expression in each gene in each of the cells in our samples? Regardless of droplet method, the following are required for proper quantification at the cellular level:\n\n\nSample index: determines which sample the read originated from (red bottom arrow)\n\nAdded during library preparation - needs to be documented\n\nCellular barcode: determines which cell the read originated from (purple top arrow)\n\nEach library preparation method has a stock of cellular barcodes used during the library preparation\n\nUnique molecular identifier (UMI): determines which transcript molecule the read originated from\n\nThe UMI will be used to collapse PCR duplicates (purple bottom arrow)\n\nSequencing read1: the Read1 sequence (red top arrow)\nSequencing read2: the Read2 sequence (purple bottom arrow)\n\nImage credit: Sarah Boswell, Director of the Single Cell Sequencing Core at HMS",
    "crumbs": [
      "Pre-reading:",
      "Generation of count matrix"
    ]
  },
  {
    "objectID": "lessons/02_SC_generation_of_count_matrix.html#single-cell-rna-seq-workflow",
    "href": "lessons/02_SC_generation_of_count_matrix.html#single-cell-rna-seq-workflow",
    "title": "Generation of count matrix",
    "section": "Single-cell RNA-seq workflow",
    "text": "Single-cell RNA-seq workflow\nThe scRNA-seq method will determine how to parse the barcodes and UMIs from the sequencing reads. So, although a few of the specific steps will slightly differ, the overall workflow will generally follow the same steps regardless of method. The general workflow is shown below:\n\nImage credit: Luecken, MD and Theis, FJ. Current best practices in single‐cell RNA‐seq analysis: a tutorial, Mol Syst Biol 2019 (doi: https://doi.org/10.15252/msb.20188746)\nThe steps of the workflow are:\n\nGeneration of the count matrix (method-specific steps): formating reads, demultiplexing samples, mapping and quantification\nQuality control of the raw counts: filtering of poor quality cells\nClustering of filtered counts: clustering cells based on similarities in transcriptional activity (cell types = different clusters)\nMarker identification and cluster annotation: identifying gene markers for each cluster and annotating known cell type clusters\nOptional downstream steps\n\nRegardless of the analysis being done, conclusions about a population based on a single sample per condition are not trustworthy. BIOLOGICAL REPLICATES ARE STILL NEEDED! That is, if you want to make conclusions that correspond to the population and not just the single sample.",
    "crumbs": [
      "Pre-reading:",
      "Generation of count matrix"
    ]
  },
  {
    "objectID": "lessons/02_SC_generation_of_count_matrix.html#generation-of-count-matrix",
    "href": "lessons/02_SC_generation_of_count_matrix.html#generation-of-count-matrix",
    "title": "Generation of count matrix",
    "section": "Generation of count matrix",
    "text": "Generation of count matrix\nWe are going to start by discussing the first part of this workflow, which is generating the count matrix from the raw sequencing data. We will focus on the 3’ end sequencing used by droplet-based methods, such as inDrops, 10X Genomics, and Drop-seq.\n\nAfter sequencing, the sequencing facility will either output the raw sequencing data as BCL or FASTQ format or will generate the count matrix. If the reads are in BCL format, then we will need to convert to FASTQ format. There is a useful command-line tool called bcl2fastq that can easily perform this conversion.\n\n\n\n\n\n\nNote\n\n\n\nWe do not demultiplex at this step in the workflow. You may have sequenced 6 samples, but the reads for all samples may be present all in the same BCL or FASTQ file.\n\n\nThe generation of the count matrix from the raw sequencing data will go through similar steps for many of the scRNA-seq methods.\n\nalevin is a command-line tool that estimates expression of scRNA-seq data for which the 3’ ends of transcripts were sequenced. umi-tools and zUMIs are additional tools that can perform these processes. These tools incorporate collapsing of UMIs to correct for amplification bias. The steps in this process include the following:\n\nFormatting reads and filtering noisy cellular barcodes\nDemultiplexing the samples\nMapping/pseudo-mapping to transcriptome\nCollapsing UMIs and quantification of reads\n\nIf using 10X Genomics library preparation method, then the Cell Ranger pipeline would be used for all of the above steps.\n\n1. Formatting reads and filtering noisy cellular barcodes\nThe FASTQ files can then be used to parse out the cell barcodes, UMIs, and sample barcodes. For droplet-based methods, many of the cellular barcodes will match a low number of reads (&lt; 1000 reads) due to:\n\nencapsulation of free floating RNA from dying cells\nsimple cells (RBCs, etc.) expressing few genes\ncells that failed for some reason\n\nThese excess barcodes need to be filtered out of the sequence data prior to read alignment. To do this filtering, the ‘cellular barcode’ and the ‘molecular barcode’ are extracted and saved for each cell. For example, if using umi-tools, the information is added to the header line for each read, with the following format:\n@HWI-ST808:130:H0B8YADXX:1:1101:2088:2222:CELL_GGTCCA:UMI_CCCT\nAGGAAGATGGAGGAGAGAAGGCGGTGAAAGAGACCTGTAAAAAGCCACCGN\n+\n@@@DDBD&gt;=AFCF+&lt;CAFHDECII:DGGGHGIGGIIIEHGIIIGIIDHII#\nKnown cellular barcodes used in the library preparation method should be known, and unknown barcodes would be dropped, while allowing for an acceptable number of mismatches to the known cellular barcodes.\n\n\n2. Demultiplexing sample reads\nThe next step of the process is to demultiplex the samples, if sequencing more than a single sample. This is the one step of this process not handled by the umi-tools, but is accomplished by zUMIs. We would need to parse the reads to determine the sample barcode associated with each cell.\n\n\n3. Mapping/pseudo-mapping to cDNAs\nTo determine which gene the read originated from, the reads are aligned using traditional (STAR) or light-weight methods (Kallisto/RapMap).\n\n\n4. Collapsing UMIs and quantification of reads\nThe duplicate UMIs are collapsed, and only the unique UMIs are quantified using a tool like Kallisto or featureCounts. The resulting output is a cell by gene matrix of counts:\n\nImage credit: extracted from Lafzi et al. Tutorial: guidelines for the experimental design of single-cell RNA sequencing studies, Nature Protocols 2018 (https://doi.org/10.1038/s41596-018-0073-y)\nEach value in the matrix represents the number of reads in a cell originating from the corresponding gene. Using the count matrix, we can explore and filter the data, keeping only the higher quality cells.",
    "crumbs": [
      "Pre-reading:",
      "Generation of count matrix"
    ]
  },
  {
    "objectID": "lessons/01_intro_to_scRNA-seq.html",
    "href": "lessons/01_intro_to_scRNA-seq.html",
    "title": "Introduction to single-cell RNA-seq",
    "section": "",
    "text": "Across human tissues there is an incredible diversity of cell types, states, and interactions. To better understand these tissues and the cell types present, single-cell RNA-seq (scRNA-seq) offers a glimpse into what genes are being expressed at the level of individual cells.\n\nImage credit: courtesy of Dr. Ayshwarya Subramanian\nThis exciting and cutting-edge method can be used to:\n\nExplore which cell types are present in a tissue\nIdentify unknown/rare cell types or states\nElucidate the changes in gene expression during differentiation processes or across time or states\nIdentify genes that are differentially expressed in particular cell types between conditions (e.g. treatment or disease)\nExplore changes in expression among a cell type while incorporating spatial, regulatory, and/or protein information\n\nPopular methods to address some of the more common investigations include:\n\n\n\n\nPrior to scRNA-seq, transcriptome analysis was performed using bulk RNA-seq, which is a method for comparing the averages of cellular expression. This method can be a good choice if looking at comparative transcriptomics (e.g. samples of the same tissue from different species), and for quantifying expression signatures in disease studies. It also has potential for the discovery of disease biomarkers if you are not expecting or not concerned about cellular heterogeneity in the sample.\nWhile bulk RNA-seq can explore differences in gene expression between conditions (e.g. treatment or disease), the differences at the cellular level are not adequately captured. For instance, in the images below, if analyzed in bulk (left) we would not detect the correct association between the expression of gene A and gene B. However, if we properly group the cells by cell type or cell state, we can see the correct correlation between the genes.\n\nImage credit: Trapnell, C. Defining cell types and states with single-cell genomics, Genome Research 2015 (doi: https://dx.doi.org/10.1101/gr.190595.115)\nDespite scRNA-seq being able to capture expression at the cellular level, sample generation and library preparation is more expensive and the analysis is much more complicated and more difficult to interpret. The complexity of analysis of scRNA-seq data involves:\n\nLarge volume of data\nLow depth of sequencing per cell\nTechnical variability across cells/samples\nBiological variability across cells/samples\n\nWe will explore each of these complexities in more detail below:\n\n\nExpression data from scRNA-seq experiments represent tens or hundreds of thousands of reads for thousands of cells. The data output is much larger, requiring higher amounts of memory to analyze, larger storage requirements, and more time to run the analyses.\n\n\n\nFor the droplet-based methods of scRNA-seq, the depth of sequencing is shallow, often detecting only 10-50% of the transcriptome per cell. This results in cells showing zero counts for many of the genes. However, in a particular cell, a zero count for a gene could either mean that the gene was not being expressed or the transcripts were just not detected. Across cells, genes with higher levels of expression tend to have fewer zeros. Due to this feature, many genes will not be detected in any cell and gene expression will be highly variable between cells.\n\n\n\n\n\n\nZero-inflated?\n\n\n\nscRNA-seq data is often referred to as zero-inflated; however, recent analyses suggest that it does not contain more zeros than what would be expected given the sequencing depth [Valentine Svensson’s blog post]. A more recent paper discussing modeling of scRNA-seq data is also available.\n\n\n\n\n\nUninteresting sources of biological variation can result in gene expression between cells being more similar/different than the actual biological cell types/states, which can obscure the cell type identities. Uninteresting sources of biological variation (unless part of the experiment’s study) include:\n\nTranscriptional bursting: Gene transcription is not turned on all of the time for all genes. Time of harvest will determine whether gene is on or off in each cell.\nVarying rates of RNA processing: Different RNAs are processed at different rates.\nContinuous or discrete cell identities (e.g. the pro-inflammatory potential of each individual T cell): Continuous phenotypes are by definition variable in gene expression, and separating the continuous from the discrete can sometimes be difficult.\nEnvironmental stimuli: The local environment of the cell can influence the gene expression depending on spatial position, signaling molecules, etc.\nTemporal changes: Fundamental fluxuating cellular processes, such as cell cycle, can affect the gene expression profiles of individual cells.\n\n\nImage credit: Wagner, A, et al. Revealing the vectors of cellular identity with single-cell genomics, Nat Biotechnol. 2016 (doi:https://dx.doi.org/10.1038%2Fnbt.3711)\n\n\n\nTechnical sources of variation can result in gene expression between cells being more similar/different based on technical sources instead of biological cell types/states, which can obscure the cell type identities. Technical sources of variation include:\n\nCell-specific capture efficiency: Different cells will have differing numbers of transcripts captured resulting in differences in sequencing depth (e.g. 10-50% of transcriptome).\nLibrary quality: Degraded RNA, low viability/dying cells, lots of free floating RNA, poorly dissociated cells, and inaccurate quantitation of cells can result in low quality metrics\nAmplification bias: During the amplification step of library preparation, not all transcripts are amplified to the same level.\nBatch effects: Batch effects are a significant issue for scRNA-Seq analyses, since you can see significant differences in expression due solely to the batch effect.\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nTo explore the issues generated by poor batch study design, they are highlighted nicely in this paper.\nHow to know whether you have batches?\n\nWere all RNA isolations performed on the same day?\nWere all library preparations performed on the same day?\nDid the same person perform the RNA isolation/library preparation for all samples?\nDid you use the same reagents for all samples?\nDid you perform the RNA isolation/library preparation in the same location?\n\nIf any of the answers is ‘No’, then you have batches.\nBest practices regarding batches:\n\nDesign the experiment in a way to avoid batches, if possible.\nIf unable to avoid batches:\n\nDo NOT confound your experiment by batch:\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nDO split replicates of the different sample groups across batches. The more replicates the better (definitely more than 2), if doing DE across conditions or making conclusions at the population level. If using inDrops, which prepares a single library at a time, alternate the sample groups (e.g. don’t prepare all control libraries first, then prepare all treatment libraries).\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nDO include batch information in your experimental metadata. During the analysis, we can regress out variation due to batch or integrate across batches, so it doesn’t affect our results if we have that information.\n\n\n\n\n\n\n\nWhile scRNA-seq is a powerful and insightful method for the analysis of gene expression with single-cell resolution, there are many challenges and sources of variation that can make the analysis of the data complex or limited. Throughout the analysis of scRNA-seq data, we will try to account for or regress out variation due to the various sources of uninteresting variation in our data.\nOverall, we recommend the following:\n\nDo not perform single-cell RNA-seq unless it is necessary for the experimental question of interest. Could you answer the question using bulk sequencing, which is simpler and less costly? Perhaps FACS sorting the samples could allow for bulk analysis?\nUnderstand the details of the experimental question you wish to address. The recommended library preparation method and analysis workflow can vary based on the specific experiment.\nAvoid technical sources of variability, if possible:\n\nDiscuss experimental design with experts prior to the initiation of the experiment\nIsolate RNA from samples at same time\nPrepare libraries at same time or alternate sample groups to avoid batch confounding\nDo not confound sample groups by sex, age, or batch\n\n\n\n\n\n\n\n\n\nHow does single-nucleus RNA-seq (snRNA-seq) compare to single-cell RNA-seq?\n\n\n\nWe will not be covering snRNA-seq in this workshop! Below is a brief overview of snRNA-seq.\nsnRNA-seq analyzes the expression profiles from nuclei, instead of intact cells. As you may expect, fewer transcripts are detected from the nuclei (~7,000 genes), compared to intact cells (~11,000 genes). In some situations (depending on your research materials and goals), snRNA-seq can be the preferred method as opposed to scRNA-seq.\nSome advantages of snRNA-seq include:\n\nWorks well with hard-to-isolate samples (for example, adipocytes), as well as frozen tissues\nReduces transcriptional artifacts from the isolation process\nProvides less biased cellular coverage",
    "crumbs": [
      "Pre-reading:",
      "Introduction to single-cell RNA-seq"
    ]
  },
  {
    "objectID": "lessons/01_intro_to_scRNA-seq.html#why-single-cell-rna-seq",
    "href": "lessons/01_intro_to_scRNA-seq.html#why-single-cell-rna-seq",
    "title": "Introduction to single-cell RNA-seq",
    "section": "",
    "text": "Across human tissues there is an incredible diversity of cell types, states, and interactions. To better understand these tissues and the cell types present, single-cell RNA-seq (scRNA-seq) offers a glimpse into what genes are being expressed at the level of individual cells.\n\nImage credit: courtesy of Dr. Ayshwarya Subramanian\nThis exciting and cutting-edge method can be used to:\n\nExplore which cell types are present in a tissue\nIdentify unknown/rare cell types or states\nElucidate the changes in gene expression during differentiation processes or across time or states\nIdentify genes that are differentially expressed in particular cell types between conditions (e.g. treatment or disease)\nExplore changes in expression among a cell type while incorporating spatial, regulatory, and/or protein information\n\nPopular methods to address some of the more common investigations include:",
    "crumbs": [
      "Pre-reading:",
      "Introduction to single-cell RNA-seq"
    ]
  },
  {
    "objectID": "lessons/01_intro_to_scRNA-seq.html#challenges-of-scrna-seq-analysis",
    "href": "lessons/01_intro_to_scRNA-seq.html#challenges-of-scrna-seq-analysis",
    "title": "Introduction to single-cell RNA-seq",
    "section": "",
    "text": "Prior to scRNA-seq, transcriptome analysis was performed using bulk RNA-seq, which is a method for comparing the averages of cellular expression. This method can be a good choice if looking at comparative transcriptomics (e.g. samples of the same tissue from different species), and for quantifying expression signatures in disease studies. It also has potential for the discovery of disease biomarkers if you are not expecting or not concerned about cellular heterogeneity in the sample.\nWhile bulk RNA-seq can explore differences in gene expression between conditions (e.g. treatment or disease), the differences at the cellular level are not adequately captured. For instance, in the images below, if analyzed in bulk (left) we would not detect the correct association between the expression of gene A and gene B. However, if we properly group the cells by cell type or cell state, we can see the correct correlation between the genes.\n\nImage credit: Trapnell, C. Defining cell types and states with single-cell genomics, Genome Research 2015 (doi: https://dx.doi.org/10.1101/gr.190595.115)\nDespite scRNA-seq being able to capture expression at the cellular level, sample generation and library preparation is more expensive and the analysis is much more complicated and more difficult to interpret. The complexity of analysis of scRNA-seq data involves:\n\nLarge volume of data\nLow depth of sequencing per cell\nTechnical variability across cells/samples\nBiological variability across cells/samples\n\nWe will explore each of these complexities in more detail below:\n\n\nExpression data from scRNA-seq experiments represent tens or hundreds of thousands of reads for thousands of cells. The data output is much larger, requiring higher amounts of memory to analyze, larger storage requirements, and more time to run the analyses.\n\n\n\nFor the droplet-based methods of scRNA-seq, the depth of sequencing is shallow, often detecting only 10-50% of the transcriptome per cell. This results in cells showing zero counts for many of the genes. However, in a particular cell, a zero count for a gene could either mean that the gene was not being expressed or the transcripts were just not detected. Across cells, genes with higher levels of expression tend to have fewer zeros. Due to this feature, many genes will not be detected in any cell and gene expression will be highly variable between cells.\n\n\n\n\n\n\nZero-inflated?\n\n\n\nscRNA-seq data is often referred to as zero-inflated; however, recent analyses suggest that it does not contain more zeros than what would be expected given the sequencing depth [Valentine Svensson’s blog post]. A more recent paper discussing modeling of scRNA-seq data is also available.\n\n\n\n\n\nUninteresting sources of biological variation can result in gene expression between cells being more similar/different than the actual biological cell types/states, which can obscure the cell type identities. Uninteresting sources of biological variation (unless part of the experiment’s study) include:\n\nTranscriptional bursting: Gene transcription is not turned on all of the time for all genes. Time of harvest will determine whether gene is on or off in each cell.\nVarying rates of RNA processing: Different RNAs are processed at different rates.\nContinuous or discrete cell identities (e.g. the pro-inflammatory potential of each individual T cell): Continuous phenotypes are by definition variable in gene expression, and separating the continuous from the discrete can sometimes be difficult.\nEnvironmental stimuli: The local environment of the cell can influence the gene expression depending on spatial position, signaling molecules, etc.\nTemporal changes: Fundamental fluxuating cellular processes, such as cell cycle, can affect the gene expression profiles of individual cells.\n\n\nImage credit: Wagner, A, et al. Revealing the vectors of cellular identity with single-cell genomics, Nat Biotechnol. 2016 (doi:https://dx.doi.org/10.1038%2Fnbt.3711)\n\n\n\nTechnical sources of variation can result in gene expression between cells being more similar/different based on technical sources instead of biological cell types/states, which can obscure the cell type identities. Technical sources of variation include:\n\nCell-specific capture efficiency: Different cells will have differing numbers of transcripts captured resulting in differences in sequencing depth (e.g. 10-50% of transcriptome).\nLibrary quality: Degraded RNA, low viability/dying cells, lots of free floating RNA, poorly dissociated cells, and inaccurate quantitation of cells can result in low quality metrics\nAmplification bias: During the amplification step of library preparation, not all transcripts are amplified to the same level.\nBatch effects: Batch effects are a significant issue for scRNA-Seq analyses, since you can see significant differences in expression due solely to the batch effect.\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nTo explore the issues generated by poor batch study design, they are highlighted nicely in this paper.\nHow to know whether you have batches?\n\nWere all RNA isolations performed on the same day?\nWere all library preparations performed on the same day?\nDid the same person perform the RNA isolation/library preparation for all samples?\nDid you use the same reagents for all samples?\nDid you perform the RNA isolation/library preparation in the same location?\n\nIf any of the answers is ‘No’, then you have batches.\nBest practices regarding batches:\n\nDesign the experiment in a way to avoid batches, if possible.\nIf unable to avoid batches:\n\nDo NOT confound your experiment by batch:\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nDO split replicates of the different sample groups across batches. The more replicates the better (definitely more than 2), if doing DE across conditions or making conclusions at the population level. If using inDrops, which prepares a single library at a time, alternate the sample groups (e.g. don’t prepare all control libraries first, then prepare all treatment libraries).\n\nImage credit: Hicks SC, et al., bioRxiv (2015)\nDO include batch information in your experimental metadata. During the analysis, we can regress out variation due to batch or integrate across batches, so it doesn’t affect our results if we have that information.",
    "crumbs": [
      "Pre-reading:",
      "Introduction to single-cell RNA-seq"
    ]
  },
  {
    "objectID": "lessons/01_intro_to_scRNA-seq.html#conclusions",
    "href": "lessons/01_intro_to_scRNA-seq.html#conclusions",
    "title": "Introduction to single-cell RNA-seq",
    "section": "",
    "text": "While scRNA-seq is a powerful and insightful method for the analysis of gene expression with single-cell resolution, there are many challenges and sources of variation that can make the analysis of the data complex or limited. Throughout the analysis of scRNA-seq data, we will try to account for or regress out variation due to the various sources of uninteresting variation in our data.\nOverall, we recommend the following:\n\nDo not perform single-cell RNA-seq unless it is necessary for the experimental question of interest. Could you answer the question using bulk sequencing, which is simpler and less costly? Perhaps FACS sorting the samples could allow for bulk analysis?\nUnderstand the details of the experimental question you wish to address. The recommended library preparation method and analysis workflow can vary based on the specific experiment.\nAvoid technical sources of variability, if possible:\n\nDiscuss experimental design with experts prior to the initiation of the experiment\nIsolate RNA from samples at same time\nPrepare libraries at same time or alternate sample groups to avoid batch confounding\nDo not confound sample groups by sex, age, or batch\n\n\n\n\n\n\n\n\n\nHow does single-nucleus RNA-seq (snRNA-seq) compare to single-cell RNA-seq?\n\n\n\nWe will not be covering snRNA-seq in this workshop! Below is a brief overview of snRNA-seq.\nsnRNA-seq analyzes the expression profiles from nuclei, instead of intact cells. As you may expect, fewer transcripts are detected from the nuclei (~7,000 genes), compared to intact cells (~11,000 genes). In some situations (depending on your research materials and goals), snRNA-seq can be the preferred method as opposed to scRNA-seq.\nSome advantages of snRNA-seq include:\n\nWorks well with hard-to-isolate samples (for example, adipocytes), as well as frozen tissues\nReduces transcriptional artifacts from the isolation process\nProvides less biased cellular coverage",
    "crumbs": [
      "Pre-reading:",
      "Introduction to single-cell RNA-seq"
    ]
  }
]